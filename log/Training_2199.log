2025-03-29 22:30:08,630 - INFO - Argument settings:
2025-03-29 22:30:08,630 - INFO - Namespace(batch_size=24, cache=False, causal=True, device='cpu', dropout=0, dynamic_type='power', early_stop_lr=9e-06, expid=2199, hidden_dim=64, init=0.01, input_dim=64, input_window=24, interval=4, k=20, learning_rate=0.001, lr_decay=0.5, lr_step=3, num_epoch=300, output_window=24, path='./', poi_data=tensor([[0.2067, 0.1120, 0.0720,  ..., 0.5573, 0.0093, 0.0973],
        [0.2278, 0.0306, 0.1694,  ..., 0.7278, 0.0222, 0.0583],
        [0.3323, 0.0160, 0.1054,  ..., 0.8307, 0.0383, 0.0256],
        ...,
        [0.5294, 0.0784, 1.0000,  ..., 0.9020, 0.0098, 0.1176],
        [0.2365, 0.0712, 0.2288,  ..., 0.5481, 0.0423, 0.2635],
        [0.3714, 0.0714, 0.7000,  ..., 0.9286, 0.0571, 0.3000]]), poi_num=17, pt_dim=64, random=False, reg_dim=64, reg_num=490, save=False, seeds=[1111, 2222, 3333, 4444, 5555], testing_rate=0.1, tim_dim=64, tim_num=24, training_rate=0.8, treat_dim=10, treat_hidden=64, validate_rate=0.1, weight_decay=0)
2025-03-29 22:30:08,646 - INFO - Packed source code saved!
2025-03-29 22:30:08,646 - INFO - Running experiment with seed: 1111
2025-03-29 22:30:08,646 - INFO - Starting data preprocessing...
2025-03-29 22:30:08,708 - INFO - Regional adjacency matrix loaded!
2025-03-29 22:30:08,708 - INFO - Regional adjacency matrix length: (600)
2025-03-29 22:30:08,708 - INFO - Adjacency matrix shape: (490, 490)
2025-03-29 22:30:08,708 - INFO - Reading Regional flows data...
2025-03-29 22:30:08,708 - INFO - Regional flows data loaded!
2025-03-29 22:30:08,708 - INFO - Regional flows datashape: (600, 490)
2025-03-29 22:30:08,708 - INFO - Start processing treatments files...
2025-03-29 22:30:08,724 - INFO - Treatment division done!
2025-03-29 22:30:08,724 - INFO - Splitting datasets...
2025-03-29 22:30:08,724 - INFO - Data shape for scaler creation is (488, 490)
2025-03-29 22:30:10,746 - INFO - Model Structure: CausalMob(
  (reg_embedding): Embedding(490, 64)
  (pt_trans): PTTrans(
    (tim_embedding): Embedding(168, 64)
    (linear): Linear(in_features=64, out_features=17, bias=True)
  )
  (linear): Sequential(
    (0): Linear(in_features=169, out_features=64, bias=True)
  )
  (res_blocks): ModuleList(
    (0): ResNormal(
      (gcn1): GCN(
        (gcn1): GraphConvolution (64 -> 64)
        (gcn2): GraphConvolution (64 -> 64)
        (dropout): Dropout(p=0, inplace=False)
      )
      (gcn2): GCN(
        (gcn1): GraphConvolution (64 -> 64)
        (gcn2): GraphConvolution (64 -> 64)
        (dropout): Dropout(p=0, inplace=False)
      )
    )
    (1): ResNormal(
      (gcn1): GCN(
        (gcn1): GraphConvolution (64 -> 64)
        (gcn2): GraphConvolution (64 -> 64)
        (dropout): Dropout(p=0, inplace=False)
      )
      (gcn2): GCN(
        (gcn1): GraphConvolution (64 -> 64)
        (gcn2): GraphConvolution (64 -> 64)
        (dropout): Dropout(p=0, inplace=False)
      )
    )
  )
  (treat_gru_prev): GRU(10, 64, batch_first=True)
  (treat_gru_post): GRU(10, 64, batch_first=True)
  (treat_linear): Linear(in_features=128, out_features=64, bias=True)
  (admit): ADMIT(
    (feature_weight): Linear(in_features=64, out_features=64, bias=True)
    (hidden_features): Sequential(
      (0): Linear(in_features=64, out_features=64, bias=True)
      (1): ReLU(inplace=True)
      (2): Linear(in_features=64, out_features=64, bias=True)
      (3): ReLU(inplace=True)
    )
    (drop_hidden): Dropout(p=0, inplace=False)
    (out): Sequential(
      (0): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
        (act): ReLU()
      )
      (1): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
      )
    )
    (rwt): Sequential(
      (0): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
        (act): ReLU()
      )
      (1): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
      )
    )
  )
)
2025-03-29 22:30:10,746 - INFO - Training...
2025-03-29 22:30:10,746 - INFO - Epoch 1
2025-03-29 22:33:05,164 - INFO - Start Validate
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 0: MSE=323434.6166, RMSE=568.7131, MAE=408.8927, MAPE=21.7362%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 1: MSE=326072.8718, RMSE=571.0279, MAE=409.4422, MAPE=21.7606%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 2: MSE=323398.6224, RMSE=568.6815, MAE=406.3330, MAPE=21.3775%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 3: MSE=328069.5641, RMSE=572.7736, MAE=408.8677, MAPE=21.5830%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 4: MSE=328933.9452, RMSE=573.5276, MAE=408.6288, MAPE=21.4799%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 5: MSE=330154.6537, RMSE=574.5909, MAE=408.6299, MAPE=21.4748%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 6: MSE=329316.9662, RMSE=573.8615, MAE=407.2871, MAPE=21.3362%
2025-03-29 22:33:07,512 - INFO - Validate Metrics for single time slot at 7: MSE=330024.1682, RMSE=574.4773, MAE=407.8495, MAPE=21.3909%
2025-03-29 22:33:07,528 - INFO - Validate Metrics for single time slot at 8: MSE=328842.0453, RMSE=573.4475, MAE=406.8736, MAPE=21.2719%
2025-03-29 22:33:07,528 - INFO - Validate Metrics for single time slot at 9: MSE=328262.1752, RMSE=572.9417, MAE=407.4187, MAPE=21.3442%
2025-03-29 22:33:07,528 - INFO - Validate Metrics for single time slot at 10: MSE=325087.9752, RMSE=570.1649, MAE=406.5646, MAPE=21.2956%
2025-03-29 22:33:07,528 - INFO - Validate Metrics for single time slot at 11: MSE=325353.6215, RMSE=570.3978, MAE=408.5706, MAPE=21.5224%
2025-03-29 22:33:07,528 - INFO - Validate Metrics for single time slot at 12: MSE=321907.8130, RMSE=567.3692, MAE=408.6542, MAPE=21.5818%
2025-03-29 22:33:07,528 - INFO - Validate Metrics for single time slot at 13: MSE=321070.9400, RMSE=566.6312, MAE=410.2468, MAPE=21.7760%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 14: MSE=318776.7724, RMSE=564.6032, MAE=408.3276, MAPE=21.5164%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 15: MSE=323826.2475, RMSE=569.0573, MAE=412.4021, MAPE=21.8634%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 16: MSE=325182.0612, RMSE=570.2474, MAE=413.1622, MAPE=21.8778%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 17: MSE=324671.7316, RMSE=569.7997, MAE=412.5617, MAPE=21.8448%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 18: MSE=326153.3450, RMSE=571.0984, MAE=412.0285, MAPE=21.7628%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 19: MSE=333696.0178, RMSE=577.6643, MAE=416.3499, MAPE=22.1019%
2025-03-29 22:33:07,543 - INFO - Validate Metrics for single time slot at 20: MSE=334428.2870, RMSE=578.2977, MAE=414.9641, MAPE=21.9270%
2025-03-29 22:33:07,559 - INFO - Validate Metrics for single time slot at 21: MSE=340925.2485, RMSE=583.8880, MAE=418.0316, MAPE=22.1300%
2025-03-29 22:33:07,559 - INFO - Validate Metrics for single time slot at 22: MSE=339366.9964, RMSE=582.5521, MAE=416.1192, MAPE=21.8902%
2025-03-29 22:33:07,559 - INFO - Validate Metrics for single time slot at 23: MSE=341197.1531, RMSE=584.1208, MAE=416.3612, MAPE=21.8615%
2025-03-29 22:33:07,621 - INFO - Validate Metrics: MSE=328256.4100, RMSE=572.9367, MAE=410.6070, MAPE=21.6544%
2025-03-29 22:33:07,621 - INFO - Validate process done.
2025-03-29 22:33:07,637 - INFO - Best model updated!
2025-03-29 22:33:07,637 - INFO - Current Learning Rate: 0.001
2025-03-29 22:33:07,637 - INFO - Epoch 2
2025-03-29 22:40:26,125 - INFO - Start Validate
2025-03-29 22:40:29,726 - INFO - Validate Metrics for single time slot at 0: MSE=313423.3593, RMSE=559.8423, MAE=406.3973, MAPE=21.6538%
2025-03-29 22:40:29,726 - INFO - Validate Metrics for single time slot at 1: MSE=317549.7790, RMSE=563.5156, MAE=406.8674, MAPE=21.6174%
2025-03-29 22:40:29,741 - INFO - Validate Metrics for single time slot at 2: MSE=329777.1318, RMSE=574.2622, MAE=412.2793, MAPE=22.0120%
2025-03-29 22:40:29,741 - INFO - Validate Metrics for single time slot at 3: MSE=331829.3562, RMSE=576.0463, MAE=412.2145, MAPE=21.9283%
2025-03-29 22:40:29,741 - INFO - Validate Metrics for single time slot at 4: MSE=334936.0974, RMSE=578.7366, MAE=413.4676, MAPE=21.9786%
2025-03-29 22:40:29,741 - INFO - Validate Metrics for single time slot at 5: MSE=332583.1255, RMSE=576.7002, MAE=411.5836, MAPE=21.8023%
2025-03-29 22:40:29,757 - INFO - Validate Metrics for single time slot at 6: MSE=328721.6194, RMSE=573.3425, MAE=409.4947, MAPE=21.6465%
2025-03-29 22:40:29,757 - INFO - Validate Metrics for single time slot at 7: MSE=328294.0441, RMSE=572.9695, MAE=410.2575, MAPE=21.7524%
2025-03-29 22:40:29,757 - INFO - Validate Metrics for single time slot at 8: MSE=322167.3713, RMSE=567.5979, MAE=407.4336, MAPE=21.5423%
2025-03-29 22:40:29,773 - INFO - Validate Metrics for single time slot at 9: MSE=316132.0366, RMSE=562.2562, MAE=404.1264, MAPE=21.2336%
2025-03-29 22:40:29,773 - INFO - Validate Metrics for single time slot at 10: MSE=313676.4806, RMSE=560.0683, MAE=404.1946, MAPE=21.2828%
2025-03-29 22:40:29,773 - INFO - Validate Metrics for single time slot at 11: MSE=311522.9349, RMSE=558.1424, MAE=405.4692, MAPE=21.4488%
2025-03-29 22:40:29,773 - INFO - Validate Metrics for single time slot at 12: MSE=305075.5084, RMSE=552.3364, MAE=401.7301, MAPE=21.1208%
2025-03-29 22:40:29,788 - INFO - Validate Metrics for single time slot at 13: MSE=303432.8535, RMSE=550.8474, MAE=401.9982, MAPE=21.1822%
2025-03-29 22:40:29,788 - INFO - Validate Metrics for single time slot at 14: MSE=308590.1810, RMSE=555.5089, MAE=406.7798, MAPE=21.5852%
2025-03-29 22:40:29,788 - INFO - Validate Metrics for single time slot at 15: MSE=307575.3270, RMSE=554.5947, MAE=405.7549, MAPE=21.4537%
2025-03-29 22:40:29,788 - INFO - Validate Metrics for single time slot at 16: MSE=305208.7162, RMSE=552.4570, MAE=403.7564, MAPE=21.2167%
2025-03-29 22:40:29,804 - INFO - Validate Metrics for single time slot at 17: MSE=307502.8404, RMSE=554.5294, MAE=405.4450, MAPE=21.4144%
2025-03-29 22:40:29,804 - INFO - Validate Metrics for single time slot at 18: MSE=308293.9575, RMSE=555.2423, MAE=405.1957, MAPE=21.3983%
2025-03-29 22:40:29,804 - INFO - Validate Metrics for single time slot at 19: MSE=310706.3083, RMSE=557.4104, MAE=405.6312, MAPE=21.3815%
2025-03-29 22:40:29,804 - INFO - Validate Metrics for single time slot at 20: MSE=315376.2036, RMSE=561.5837, MAE=407.5007, MAPE=21.5160%
2025-03-29 22:40:29,819 - INFO - Validate Metrics for single time slot at 21: MSE=319656.6484, RMSE=565.3819, MAE=409.9065, MAPE=21.6885%
2025-03-29 22:40:29,819 - INFO - Validate Metrics for single time slot at 22: MSE=324112.9697, RMSE=569.3092, MAE=411.6617, MAPE=21.7781%
2025-03-29 22:40:29,819 - INFO - Validate Metrics for single time slot at 23: MSE=328041.4272, RMSE=572.7490, MAE=412.4159, MAPE=21.7564%
2025-03-29 22:40:29,929 - INFO - Validate Metrics: MSE=317674.4282, RMSE=563.6261, MAE=407.5651, MAPE=21.5579%
2025-03-29 22:40:29,929 - INFO - Validate process done.
2025-03-29 22:40:29,960 - INFO - Best model updated!
2025-03-29 22:40:29,960 - INFO - Current Learning Rate: 0.001
2025-03-29 22:40:29,960 - INFO - Epoch 3
2025-03-29 22:46:39,139 - INFO - Start Validate
2025-03-29 22:46:42,857 - INFO - Validate Metrics for single time slot at 0: MSE=300971.1366, RMSE=548.6084, MAE=401.9462, MAPE=21.4752%
2025-03-29 22:46:42,861 - INFO - Validate Metrics for single time slot at 1: MSE=311260.6214, RMSE=557.9074, MAE=405.4424, MAPE=21.6733%
2025-03-29 22:46:42,865 - INFO - Validate Metrics for single time slot at 2: MSE=321529.7170, RMSE=567.0359, MAE=408.6994, MAPE=21.8330%
2025-03-29 22:46:42,870 - INFO - Validate Metrics for single time slot at 3: MSE=325804.9152, RMSE=570.7932, MAE=408.9469, MAPE=21.7369%
2025-03-29 22:46:42,874 - INFO - Validate Metrics for single time slot at 4: MSE=331541.5696, RMSE=575.7965, MAE=411.3771, MAPE=21.8364%
2025-03-29 22:46:42,878 - INFO - Validate Metrics for single time slot at 5: MSE=330482.1253, RMSE=574.8757, MAE=409.5436, MAPE=21.5990%
2025-03-29 22:46:42,881 - INFO - Validate Metrics for single time slot at 6: MSE=329088.3404, RMSE=573.6622, MAE=409.1815, MAPE=21.5768%
2025-03-29 22:46:42,885 - INFO - Validate Metrics for single time slot at 7: MSE=328649.4654, RMSE=573.2796, MAE=409.4529, MAPE=21.6142%
2025-03-29 22:46:42,889 - INFO - Validate Metrics for single time slot at 8: MSE=331628.6490, RMSE=575.8721, MAE=411.7811, MAPE=21.8316%
2025-03-29 22:46:42,894 - INFO - Validate Metrics for single time slot at 9: MSE=324118.9510, RMSE=569.3145, MAE=408.3725, MAPE=21.5420%
2025-03-29 22:46:42,898 - INFO - Validate Metrics for single time slot at 10: MSE=323242.2941, RMSE=568.5440, MAE=408.6237, MAPE=21.5719%
2025-03-29 22:46:42,902 - INFO - Validate Metrics for single time slot at 11: MSE=322889.1772, RMSE=568.2334, MAE=410.2473, MAPE=21.7301%
2025-03-29 22:46:42,905 - INFO - Validate Metrics for single time slot at 12: MSE=315235.3875, RMSE=561.4583, MAE=407.4248, MAPE=21.5250%
2025-03-29 22:46:42,909 - INFO - Validate Metrics for single time slot at 13: MSE=314415.2645, RMSE=560.7274, MAE=408.9048, MAPE=21.6970%
2025-03-29 22:46:42,913 - INFO - Validate Metrics for single time slot at 14: MSE=312572.0918, RMSE=559.0815, MAE=408.4396, MAPE=21.6466%
2025-03-29 22:46:42,917 - INFO - Validate Metrics for single time slot at 15: MSE=316386.0790, RMSE=562.4821, MAE=411.5419, MAPE=21.9277%
2025-03-29 22:46:42,921 - INFO - Validate Metrics for single time slot at 16: MSE=308760.8288, RMSE=555.6625, MAE=406.7599, MAPE=21.5066%
2025-03-29 22:46:42,925 - INFO - Validate Metrics for single time slot at 17: MSE=308931.2305, RMSE=555.8158, MAE=407.6363, MAPE=21.6645%
2025-03-29 22:46:42,929 - INFO - Validate Metrics for single time slot at 18: MSE=301834.1978, RMSE=549.3944, MAE=402.4867, MAPE=21.2607%
2025-03-29 22:46:42,933 - INFO - Validate Metrics for single time slot at 19: MSE=302752.0542, RMSE=550.2291, MAE=402.5466, MAPE=21.2630%
2025-03-29 22:46:42,937 - INFO - Validate Metrics for single time slot at 20: MSE=304097.2724, RMSE=551.4502, MAE=401.9368, MAPE=21.1748%
2025-03-29 22:46:42,941 - INFO - Validate Metrics for single time slot at 21: MSE=308016.9855, RMSE=554.9928, MAE=402.9466, MAPE=21.1735%
2025-03-29 22:46:42,945 - INFO - Validate Metrics for single time slot at 22: MSE=313528.8387, RMSE=559.9365, MAE=403.9358, MAPE=21.1132%
2025-03-29 22:46:42,949 - INFO - Validate Metrics for single time slot at 23: MSE=320989.2055, RMSE=566.5591, MAE=406.9082, MAPE=21.2638%
2025-03-29 22:46:43,053 - INFO - Validate Metrics: MSE=317030.2666, RMSE=563.0544, MAE=407.2951, MAPE=21.5515%
2025-03-29 22:46:43,053 - INFO - Validate process done.
2025-03-29 22:46:43,080 - INFO - Best model updated!
2025-03-29 22:46:43,080 - INFO - Current Learning Rate: 0.001
2025-03-29 22:46:43,080 - INFO - Epoch 4

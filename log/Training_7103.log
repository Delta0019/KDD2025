2025-03-31 21:28:29,470 - INFO - Argument settings:
2025-03-31 21:28:29,471 - INFO - Namespace(reg_dim=64, tim_dim=64, hidden_dim=64, init=0.01, dynamic_type='power', dropout=0, learning_rate=0.001, weight_decay=0, input_dim=64, treat_dim=10, treat_hidden=64, reg_num=490, tim_num=24, device='cuda:0', path='./', batch_size=12, num_epoch=300, input_window=24, interval=4, output_window=24, k=20, training_rate=0.8, validate_rate=0.1, testing_rate=0.1, causal=True, lr_step=3, early_stop_lr=9e-06, lr_decay=0.5, cache=False, save=False, random=False, seeds=[1111, 2222, 3333, 4444, 5555], poi_num=17, poi_data=tensor([[0.2067, 0.1120, 0.0720,  ..., 0.5573, 0.0093, 0.0973],
        [0.2278, 0.0306, 0.1694,  ..., 0.7278, 0.0222, 0.0583],
        [0.3323, 0.0160, 0.1054,  ..., 0.8307, 0.0383, 0.0256],
        ...,
        [0.5294, 0.0784, 1.0000,  ..., 0.9020, 0.0098, 0.1176],
        [0.2365, 0.0712, 0.2288,  ..., 0.5481, 0.0423, 0.2635],
        [0.3714, 0.0714, 0.7000,  ..., 0.9286, 0.0571, 0.3000]]), pt_dim=64, expid=7103)
2025-03-31 21:28:29,480 - INFO - Packed source code saved!
2025-03-31 21:28:29,480 - INFO - Running experiment with seed: 1111
2025-03-31 21:28:29,483 - INFO - Starting data preprocessing...
2025-03-31 21:28:29,727 - INFO - Regional adjacency matrix loaded!
2025-03-31 21:28:29,727 - INFO - Regional adjacency matrix length: (600)
2025-03-31 21:28:29,727 - INFO - Adjacency matrix shape: (490, 490)
2025-03-31 21:28:29,727 - INFO - Reading Regional flows data...
2025-03-31 21:28:29,730 - INFO - Regional flows data loaded!
2025-03-31 21:28:29,730 - INFO - Regional flows datashape: (600, 490)
2025-03-31 21:28:29,730 - INFO - Start processing treatments files...
2025-03-31 21:28:29,759 - INFO - Treatment division done!
2025-03-31 21:28:29,759 - INFO - Splitting datasets...
2025-03-31 21:28:29,759 - INFO - Data shape for scaler creation is (488, 490)
2025-03-31 21:28:33,692 - INFO - Model Structure: CausalMob(
  (reg_embedding): Embedding(490, 64)
  (pt_trans): PTTrans(
    (tim_embedding): Embedding(168, 64)
    (linear): Linear(in_features=64, out_features=17, bias=True)
  )
  (linear): Sequential(
    (0): Linear(in_features=169, out_features=64, bias=True)
  )
  (res_blocks): ModuleList(
    (0-1): 2 x ResNormal(
      (gcn1): GCN(
        (gcn1): GraphConvolution (64 -> 64)
        (gcn2): GraphConvolution (64 -> 64)
        (dropout): Dropout(p=0, inplace=False)
      )
      (gcn2): GCN(
        (gcn1): GraphConvolution (64 -> 64)
        (gcn2): GraphConvolution (64 -> 64)
        (dropout): Dropout(p=0, inplace=False)
      )
    )
  )
  (treat_gru_prev): GRU(10, 64, batch_first=True)
  (treat_gru_post): GRU(10, 64, batch_first=True)
  (treat_linear): Linear(in_features=128, out_features=64, bias=True)
  (admit): ADMIT(
    (feature_weight): Linear(in_features=64, out_features=64, bias=True)
    (hidden_features): Sequential(
      (0): Linear(in_features=64, out_features=64, bias=True)
      (1): ReLU(inplace=True)
      (2): Linear(in_features=64, out_features=64, bias=True)
      (3): ReLU(inplace=True)
    )
    (drop_hidden): Dropout(p=0, inplace=False)
    (out): Sequential(
      (0): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
        (act): ReLU()
      )
      (1): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
      )
    )
    (rwt): Sequential(
      (0): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
        (act): ReLU()
      )
      (1): Dynamic_FC(
        (spb): MLP_treatnet(
          (hidden1): Linear(in_features=4, out_features=64, bias=True)
          (predict): Linear(in_features=64, out_features=64, bias=True)
          (act): ReLU()
        )
      )
    )
  )
)
2025-03-31 21:28:34,585 - INFO - Training...
2025-03-31 21:28:34,585 - INFO - Epoch 1
2025-03-31 21:28:45,224 - INFO - Start Validate
2025-03-31 21:28:45,826 - INFO - Validate Metrics for single time slot at 0: MSE=310160.3487, RMSE=556.9204, MAE=406.6280, MAPE=21.8450%
2025-03-31 21:28:45,828 - INFO - Validate Metrics for single time slot at 1: MSE=314084.0725, RMSE=560.4320, MAE=406.6280, MAPE=21.7453%
2025-03-31 21:28:45,829 - INFO - Validate Metrics for single time slot at 2: MSE=322673.1383, RMSE=568.0433, MAE=410.2267, MAPE=21.9733%
2025-03-31 21:28:45,830 - INFO - Validate Metrics for single time slot at 3: MSE=322148.4562, RMSE=567.5812, MAE=407.7346, MAPE=21.6145%
2025-03-31 21:28:45,832 - INFO - Validate Metrics for single time slot at 4: MSE=327838.6966, RMSE=572.5720, MAE=410.3641, MAPE=21.7443%
2025-03-31 21:28:45,833 - INFO - Validate Metrics for single time slot at 5: MSE=329154.4196, RMSE=573.7198, MAE=410.1930, MAPE=21.6861%
2025-03-31 21:28:45,835 - INFO - Validate Metrics for single time slot at 6: MSE=329100.4893, RMSE=573.6728, MAE=409.8084, MAPE=21.6319%
2025-03-31 21:28:45,836 - INFO - Validate Metrics for single time slot at 7: MSE=327063.2403, RMSE=571.8944, MAE=407.5035, MAPE=21.3841%
2025-03-31 21:28:45,838 - INFO - Validate Metrics for single time slot at 8: MSE=325838.8679, RMSE=570.8230, MAE=407.1966, MAPE=21.3764%
2025-03-31 21:28:45,839 - INFO - Validate Metrics for single time slot at 9: MSE=326466.1887, RMSE=571.3722, MAE=407.0609, MAPE=21.3214%
2025-03-31 21:28:45,841 - INFO - Validate Metrics for single time slot at 10: MSE=323279.7028, RMSE=568.5769, MAE=406.3948, MAPE=21.2947%
2025-03-31 21:28:45,842 - INFO - Validate Metrics for single time slot at 11: MSE=324177.5333, RMSE=569.3659, MAE=407.2539, MAPE=21.3328%
2025-03-31 21:28:45,843 - INFO - Validate Metrics for single time slot at 12: MSE=319088.0207, RMSE=564.8788, MAE=406.0034, MAPE=21.2920%
2025-03-31 21:28:45,845 - INFO - Validate Metrics for single time slot at 13: MSE=315219.0562, RMSE=561.4437, MAE=405.0213, MAPE=21.2276%
2025-03-31 21:28:45,846 - INFO - Validate Metrics for single time slot at 14: MSE=315931.6984, RMSE=562.0780, MAE=407.2451, MAPE=21.4485%
2025-03-31 21:28:45,847 - INFO - Validate Metrics for single time slot at 15: MSE=311545.6933, RMSE=558.1628, MAE=406.0313, MAPE=21.3560%
2025-03-31 21:28:45,848 - INFO - Validate Metrics for single time slot at 16: MSE=314999.1572, RMSE=561.2479, MAE=409.9810, MAPE=21.7215%
2025-03-31 21:28:45,850 - INFO - Validate Metrics for single time slot at 17: MSE=305528.6910, RMSE=552.7465, MAE=404.9598, MAPE=21.3820%
2025-03-31 21:28:45,851 - INFO - Validate Metrics for single time slot at 18: MSE=307314.1330, RMSE=554.3592, MAE=405.8867, MAPE=21.5137%
2025-03-31 21:28:45,853 - INFO - Validate Metrics for single time slot at 19: MSE=309920.0726, RMSE=556.7047, MAE=407.0147, MAPE=21.5947%
2025-03-31 21:28:45,853 - INFO - Validate Metrics for single time slot at 20: MSE=313087.3977, RMSE=559.5421, MAE=408.3258, MAPE=21.7131%
2025-03-31 21:28:45,855 - INFO - Validate Metrics for single time slot at 21: MSE=314025.2910, RMSE=560.3796, MAE=407.4509, MAPE=21.5604%
2025-03-31 21:28:45,856 - INFO - Validate Metrics for single time slot at 22: MSE=322596.7811, RMSE=567.9760, MAE=411.7895, MAPE=21.8542%
2025-03-31 21:28:45,857 - INFO - Validate Metrics for single time slot at 23: MSE=327614.7923, RMSE=572.3764, MAE=412.6214, MAPE=21.8155%
2025-03-31 21:28:45,898 - INFO - Validate Metrics: MSE=319118.9974, RMSE=564.9062, MAE=407.8885, MAPE=21.5595%
2025-03-31 21:28:45,898 - INFO - Validate process done.
2025-03-31 21:28:45,909 - INFO - Best model updated!
2025-03-31 21:28:45,910 - INFO - Current Learning Rate: 0.001
2025-03-31 21:28:45,910 - INFO - Epoch 2
2025-03-31 21:28:55,449 - INFO - Start Validate
2025-03-31 21:28:56,018 - INFO - Validate Metrics for single time slot at 0: MSE=294528.5842, RMSE=542.7049, MAE=398.4932, MAPE=21.1103%
2025-03-31 21:28:56,019 - INFO - Validate Metrics for single time slot at 1: MSE=306047.8953, RMSE=553.2160, MAE=403.3075, MAPE=21.4545%
2025-03-31 21:28:56,021 - INFO - Validate Metrics for single time slot at 2: MSE=312807.9924, RMSE=559.2924, MAE=404.7351, MAPE=21.4573%
2025-03-31 21:28:56,022 - INFO - Validate Metrics for single time slot at 3: MSE=320574.4072, RMSE=566.1929, MAE=407.9175, MAPE=21.6424%
2025-03-31 21:28:56,023 - INFO - Validate Metrics for single time slot at 4: MSE=326017.9238, RMSE=570.9798, MAE=409.6414, MAPE=21.6849%
2025-03-31 21:28:56,024 - INFO - Validate Metrics for single time slot at 5: MSE=325641.8863, RMSE=570.6504, MAE=408.2660, MAPE=21.5363%
2025-03-31 21:28:56,027 - INFO - Validate Metrics for single time slot at 6: MSE=329560.5077, RMSE=574.0736, MAE=410.8309, MAPE=21.7827%
2025-03-31 21:28:56,028 - INFO - Validate Metrics for single time slot at 7: MSE=326876.4590, RMSE=571.7311, MAE=410.0115, MAPE=21.7475%
2025-03-31 21:28:56,030 - INFO - Validate Metrics for single time slot at 8: MSE=329782.4151, RMSE=574.2669, MAE=412.5310, MAPE=21.9813%
2025-03-31 21:28:56,031 - INFO - Validate Metrics for single time slot at 9: MSE=322854.3489, RMSE=568.2027, MAE=408.7709, MAPE=21.6632%
2025-03-31 21:28:56,032 - INFO - Validate Metrics for single time slot at 10: MSE=321386.1780, RMSE=566.9093, MAE=408.9396, MAPE=21.7080%
2025-03-31 21:28:56,034 - INFO - Validate Metrics for single time slot at 11: MSE=316250.6718, RMSE=562.3617, MAE=407.4470, MAPE=21.5999%
2025-03-31 21:28:56,034 - INFO - Validate Metrics for single time slot at 12: MSE=320398.1220, RMSE=566.0372, MAE=411.6828, MAPE=21.9830%
2025-03-31 21:28:56,037 - INFO - Validate Metrics for single time slot at 13: MSE=312024.0257, RMSE=558.5911, MAE=407.6939, MAPE=21.6760%
2025-03-31 21:28:56,038 - INFO - Validate Metrics for single time slot at 14: MSE=312515.8800, RMSE=559.0312, MAE=408.4333, MAPE=21.6936%
2025-03-31 21:28:56,039 - INFO - Validate Metrics for single time slot at 15: MSE=313941.7999, RMSE=560.3051, MAE=409.2553, MAPE=21.7351%
2025-03-31 21:28:56,040 - INFO - Validate Metrics for single time slot at 16: MSE=315561.0429, RMSE=561.7482, MAE=410.1991, MAPE=21.7760%
2025-03-31 21:28:56,042 - INFO - Validate Metrics for single time slot at 17: MSE=318189.4810, RMSE=564.0829, MAE=411.6021, MAPE=21.9230%
2025-03-31 21:28:56,043 - INFO - Validate Metrics for single time slot at 18: MSE=312759.2752, RMSE=559.2488, MAE=407.5904, MAPE=21.5935%
2025-03-31 21:28:56,045 - INFO - Validate Metrics for single time slot at 19: MSE=314159.5442, RMSE=560.4994, MAE=407.9738, MAPE=21.6084%
2025-03-31 21:28:56,046 - INFO - Validate Metrics for single time slot at 20: MSE=315731.1977, RMSE=561.8996, MAE=408.4165, MAPE=21.6401%
2025-03-31 21:28:56,047 - INFO - Validate Metrics for single time slot at 21: MSE=315984.6616, RMSE=562.1251, MAE=407.8463, MAPE=21.5500%
2025-03-31 21:28:56,049 - INFO - Validate Metrics for single time slot at 22: MSE=317718.5158, RMSE=563.6653, MAE=407.1072, MAPE=21.3824%
2025-03-31 21:28:56,050 - INFO - Validate Metrics for single time slot at 23: MSE=324699.6120, RMSE=569.8242, MAE=409.8634, MAPE=21.5500%
2025-03-31 21:28:56,092 - INFO - Validate Metrics: MSE=317750.5178, RMSE=563.6936, MAE=408.2732, MAPE=21.6450%
2025-03-31 21:28:56,092 - INFO - Validate process done.
2025-03-31 21:28:56,104 - INFO - Best model updated!
2025-03-31 21:28:56,104 - INFO - Current Learning Rate: 0.001
2025-03-31 21:28:56,104 - INFO - Epoch 3
2025-03-31 21:29:05,988 - INFO - Start Validate
2025-03-31 21:29:06,547 - INFO - Validate Metrics for single time slot at 0: MSE=291162.6177, RMSE=539.5949, MAE=399.5275, MAPE=21.2891%
2025-03-31 21:29:06,549 - INFO - Validate Metrics for single time slot at 1: MSE=303165.9538, RMSE=550.6051, MAE=403.6059, MAPE=21.4942%
2025-03-31 21:29:06,550 - INFO - Validate Metrics for single time slot at 2: MSE=313664.8364, RMSE=560.0579, MAE=406.6205, MAPE=21.6200%
2025-03-31 21:29:06,551 - INFO - Validate Metrics for single time slot at 3: MSE=319026.6874, RMSE=564.8245, MAE=407.3228, MAPE=21.5771%
2025-03-31 21:29:06,553 - INFO - Validate Metrics for single time slot at 4: MSE=328941.3369, RMSE=573.5341, MAE=410.2605, MAPE=21.6884%
2025-03-31 21:29:06,554 - INFO - Validate Metrics for single time slot at 5: MSE=331723.7019, RMSE=575.9546, MAE=410.4862, MAPE=21.6759%
2025-03-31 21:29:06,556 - INFO - Validate Metrics for single time slot at 6: MSE=332985.5967, RMSE=577.0490, MAE=410.8880, MAPE=21.7170%
2025-03-31 21:29:06,558 - INFO - Validate Metrics for single time slot at 7: MSE=328151.4633, RMSE=572.8451, MAE=409.3072, MAPE=21.6322%
2025-03-31 21:29:06,559 - INFO - Validate Metrics for single time slot at 8: MSE=326844.3576, RMSE=571.7030, MAE=410.4402, MAPE=21.8197%
2025-03-31 21:29:06,560 - INFO - Validate Metrics for single time slot at 9: MSE=320039.7743, RMSE=565.7206, MAE=407.5448, MAPE=21.6380%
2025-03-31 21:29:06,562 - INFO - Validate Metrics for single time slot at 10: MSE=311639.8646, RMSE=558.2471, MAE=404.0871, MAPE=21.4189%
2025-03-31 21:29:06,563 - INFO - Validate Metrics for single time slot at 11: MSE=306653.0893, RMSE=553.7627, MAE=402.9042, MAPE=21.3512%
2025-03-31 21:29:06,564 - INFO - Validate Metrics for single time slot at 12: MSE=303698.7023, RMSE=551.0887, MAE=403.1067, MAPE=21.4239%
2025-03-31 21:29:06,565 - INFO - Validate Metrics for single time slot at 13: MSE=298084.8757, RMSE=545.9715, MAE=400.4918, MAPE=21.2341%
2025-03-31 21:29:06,567 - INFO - Validate Metrics for single time slot at 14: MSE=300069.5939, RMSE=547.7861, MAE=401.3181, MAPE=21.2451%
2025-03-31 21:29:06,568 - INFO - Validate Metrics for single time slot at 15: MSE=300490.8113, RMSE=548.1704, MAE=401.0347, MAPE=21.1795%
2025-03-31 21:29:06,569 - INFO - Validate Metrics for single time slot at 16: MSE=303106.9302, RMSE=550.5515, MAE=401.8940, MAPE=21.1946%
2025-03-31 21:29:06,571 - INFO - Validate Metrics for single time slot at 17: MSE=302043.9487, RMSE=549.5853, MAE=400.7426, MAPE=21.1264%
2025-03-31 21:29:06,573 - INFO - Validate Metrics for single time slot at 18: MSE=300963.6082, RMSE=548.6015, MAE=400.4742, MAPE=21.1195%
2025-03-31 21:29:06,574 - INFO - Validate Metrics for single time slot at 19: MSE=299422.3633, RMSE=547.1950, MAE=398.9231, MAPE=20.9603%
2025-03-31 21:29:06,575 - INFO - Validate Metrics for single time slot at 20: MSE=300588.3510, RMSE=548.2594, MAE=400.4799, MAPE=21.1205%
2025-03-31 21:29:06,577 - INFO - Validate Metrics for single time slot at 21: MSE=301040.5975, RMSE=548.6717, MAE=400.8270, MAPE=21.1201%
2025-03-31 21:29:06,578 - INFO - Validate Metrics for single time slot at 22: MSE=307106.5052, RMSE=554.1719, MAE=403.7664, MAPE=21.2844%
2025-03-31 21:29:06,579 - INFO - Validate Metrics for single time slot at 23: MSE=313029.2787, RMSE=559.4902, MAE=405.2558, MAPE=21.3100%
2025-03-31 21:29:06,619 - INFO - Validate Metrics: MSE=310151.8686, RMSE=556.9128, MAE=404.2212, MAPE=21.3850%
2025-03-31 21:29:06,619 - INFO - Validate process done.
2025-03-31 21:29:06,631 - INFO - Best model updated!
2025-03-31 21:29:06,631 - INFO - Current Learning Rate: 0.001
2025-03-31 21:29:06,631 - INFO - Epoch 4
